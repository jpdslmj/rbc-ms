<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body>
<br/>
	<input id="printView" type="button" class="btn  btn-primary" value="预览打印" onClick="printme()">
	<input type="button" class="btn  btn-primary" value="打印" onClick="doPrint()">
    <a type="button" class="btn btn-primary" id="close" href="javascript:location.href='/biz/testTool'">
			<i class="fa fa-sign-out"></i>关闭页面
    </a>

</div>
	<!--startprint1-->
	<object classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"   id="WebBrowser"></object>
	<div class="wrapper wrapper-content ">
		<table  cellspacing="0" cellpadding="0" border="1" width="800" align="center" height="100%" style="text-align:center;vertical-align:top;border-collapse:collapse;">
			<caption style="text-align:center"><h2>试验工作台检视记录表</h2></caption>
			<tr height="30">
				<td width="100">风表误差：</td>
				<td colspan="2">
					<span>±10范围</span>
					<input id="windErrorValue" name="windErrorValue" type="checkbox" disabled=true th:checked="${testTool.windErrorValue}?true:false">
				</td>
				<td width="100">是否超期：</td>
				<td colspan="2">
					<span>是</span>
					<input id="isWindExced" name="isWindExced" type="checkbox" disabled=true th:checked="${testTool.isWindExced}?true:false">
					<span>否</span>
					<input id="isWindExced1" name="isWindExced1" type="checkbox" disabled=true th:checked="${testTool.isWindExced}?false:true">
				</td>
			</tr>
			<tr height="30">
				<td width="100">温度（℃）：</td>
				<td colspan="2" th:text="${testTool.temperature}"></td>
				<td width="100">湿度（%）：</td>
				<td colspan="2" th:text="${testTool.humidity}"></td>
			</tr>
			<tr>
				<td colspan="6">机能试验</td>
			</tr>
			<tr height="30">
				<td>705试验台1：</td>
				<td>
					<span>合格</span>
					<input id="fu705test1" name="fu705test1" type="checkbox" disabled=true th:checked="${testTool.fu705test1}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fu705test11" name="fu705test11" type="checkbox" disabled=true th:checked="${testTool.fu705test1}?false:false">
				</td>
				<td>备注</td>
				<td colspan="2" th:text="${testTool.mk705test1}"></td>
			</tr>
			<tr height="30">
				<td>705试验台2：</td>
				<td>
					<span>合格</span>
					<input id="fu705test2" name="fu705test2" type="checkbox" disabled=true th:checked="${testTool.fu705test2}?true:false">
				</td>
				<td >
					<span>不合格</span>
					<input id="fu705test21" name="fu705test21" type="checkbox" disabled=true th:checked="${testTool.fu705test2}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2" th:text="${testTool.mk705test2}"></td>
			</tr>
			<tr height="30">
				<td>705试验台2：</td>
				<td>
					<span>合格</span>
					<input id="fu705test3" name="fu705test3" type="checkbox" disabled=true th:checked="${testTool.fu705test3}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fu705test31" name="fu705test31" type="checkbox" disabled=true th:checked="${testTool.fu705test3}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2" th:text="${testTool.mk705test3}"></td>
			</tr>
			<tr height="30">
				<td>F8试验台1：</td>
				<td>
					<span>合格</span>
					<input id="fuf8test1" name="fuf8test1" type="checkbox" disabled=true th:checked="${testTool.fuf8test1}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fuf8test11" name="fuf8test11" type="checkbox" disabled=true th:checked="${testTool.fuf8test1}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2" th:text="${testTool.mk705test3}"></td>
			</tr>
			<tr height="30">
				<td>F8试验台2：</td>
				<td>
					<span>合格</span>
					<input id="fuf8test2" name="fuf8test2" type="checkbox" disabled=true th:checked="${testTool.fuf8test2}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fuf8test21" name="fuf8test21" type="checkbox" disabled=true th:checked="${testTool.fuf8test2}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2" th:text="${testTool.mk705test3}"></td>
			</tr>
			<tr>
				<td colspan="6">故障试验</td>
			</tr>
			<tr height="30">
				<td>705试验台1：</td>
				<td>
					<span>合格</span>
					<input id="fa705test1" name="fa705test1" type="checkbox" disabled=true th:checked="${testTool.fa705test1}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fa705test11" name="fa705test11" type="checkbox" disabled=true th:checked="${testTool.fa705test1}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2"></td>
			</tr>
			<tr height="30">
				<td>705试验台2：</td>
				<td>
					<span>合格</span>
					<input id="fa705test2" name="fa705test2" type="checkbox" disabled=true th:checked="${testTool.fa705test2}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fa705test21" name="fa705test21" type="checkbox" disabled=true th:checked="${testTool.fa705test2}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2"></td>
			</tr>
			<tr height="30">
				<td>705试验台3：</td>
				<td>
					<span>合格</span>
					<input id="fa705test3" name="fa705test3" type="checkbox" disabled=true th:checked="${testTool.fa705test3}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="fa705test31" name="fa705test31" type="checkbox" disabled=true th:checked="${testTool.fa705test3}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2"></td>
			</tr>
			<tr height="30">
				<td>F8试验台1：</td>

				<td>
					<span>合格</span>
					<input id="faf8test1" name="faf8test1" type="checkbox" disabled=true th:checked="${testTool.faf8test1}?true:false">
				</td>
				<td>
					<span>不合格</span>
					<input id="faf8test11" name="faf8test11" type="checkbox" disabled=true th:checked="${testTool.faf8test1}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2"></td>
			</tr>
			<tr height="30">
				<td>F8试验台2：</td>
				<td>
					<span>合格</span>
					<input id="faf8test2" name="faf8test2" type="checkbox" disabled=true th:checked="${testTool.faf8test2}?true:false">
				</td>

				<td>
					<span>不合格</span>
					<input id="faf8test21" name="faf8test21" type="checkbox" disabled=true th:checked="${testTool.faf8test2}?false:true">
				</td>
				<td>备注</td>
				<td colspan="2"></td>
			</tr>
			<tr height="25">
				<td>工作者名称：</td>
				<td th:text="${testTool.testerName}"></td>
				<td>工作者工号：</td>
				<td th:text="${testTool.testerNo}"></td>
				<td>提交日期：</td>
				<td th:text="${#dates.format(testTool.createTime,'yyyy-MM-dd HH:mm:ss')}"></td>
			</tr>
			<tr height="25">
				<td>工长：</td>
				<td colspan="2" th:text="${testTool.gangmasterName}"></td>
				<td>开工意见：</td>
				<td colspan="2" th:text="${testTool.gangmasterAudit}==1?'同意开工':'退回'"></td>
			</tr>
			<tr height="25">
				<td>质检员：</td>
				<td colspan="2" th:text="${testTool.inspectorName}"></td>
				<td>开工意见：</td>
				<td colspan="2" th:text="${testTool.inspectorAudit}==1?'同意开工':'退回'"></td>
			</tr>
		</table>
	</div>
	<!--endprint1-->
	<div th:include="include::footer"></div>
	<script src="/js/plugins/jcpfree/jcpfree.js"></script>

<script>
    function doPrint() {
	    var  bdhtml=window.document.body.innerHTML;//获取当前页的html代码
        var  sprnstr="<!--startprint1-->";//设置打印开始区域
        var  eprnstr="<!--endprint1-->";//设置打印结束区域
        var  prnhtml=bdhtml.substring(bdhtml.indexOf(sprnstr)+18); //从开始代码向后取html
		prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr));//从结束代码向前取html
        window.document.body.innerHTML=prnhtml;
		window.print();
        window.document.body.innerHTML=bdhtml;
    }
    function printme()
    {   var head="<!DOCTYPE html>\n" +
        "<html>\n" +
        "<meta charset=\"utf-8\">\n" +
        "<body>";
      var tail="</body>\n" +
          "</html>";
        ///var print = this.document.getElementById("print").innerHTML;
        var  bdhtml=window.document.body.innerHTML;//获取当前页的html代码
        var  sprnstr="<!--startprint1-->";//设置打印开始区域
        var  eprnstr="<!--endprint1-->";//设置打印结束区域
        var  prnhtml=bdhtml.substring(bdhtml.indexOf(sprnstr)+18); //从开始代码向后取html
        prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr));//从结束代码向前取html

        prnhtml =head+ prnhtml+"<input id=printView name=Button onClick=printView() type=button value=打印预览> <input id = print name=Button   onClick=print()   type=button   value=直接打印>   <input id = pageSetup name=Button   onClick= pageSetup() type=button   value=页面设置>" ;
        prnhtml = prnhtml +'<script> function printView(){hidden();document.all.WebBrowser.ExecWB(7,1); } function print(){hidden();document.all.WebBrowser.ExecWB(6,6)}function pageSetup(){hidden();document.all.WebBrowser.ExecWB(8,1);}function hidden(){document.all("printView").style.display="none"; document.all("print").style.display="none"; document.all("pageSetup").style.display="none";}<\/script>'+tail;
        var newWindow = window.open();
        newWindow.document.open("text/html");
        newWindow.document.write(prnhtml);
        newWindow.document.close();
    }
</script>
</body>
</html>
